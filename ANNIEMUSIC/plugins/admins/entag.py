from ANNIEMUSIC import app 
import asyncio
import random
from pyrogram import Client, filters
from pyrogram.enums import ChatType, ChatMemberStatus
from pyrogram.errors import UserNotParticipant
from pyrogram.types import ChatPermissions

spam_chats = []

EMOJI = [ "ЁЯжЛЁЯжЛЁЯжЛЁЯжЛЁЯжЛ",
          "ЁЯзЪЁЯМ╕ЁЯзЛЁЯНмЁЯлЦ",
          "ЁЯеАЁЯМ╖ЁЯМ╣ЁЯМ║ЁЯТР",
          "ЁЯМ╕ЁЯМ┐ЁЯТоЁЯМ▒ЁЯМ╡",
          "тЭдя╕ПЁЯТЪЁЯТЩЁЯТЬЁЯЦд",
          "ЁЯТУЁЯТХЁЯТЮЁЯТЧЁЯТЦ",
          "ЁЯМ╕ЁЯТРЁЯМ║ЁЯМ╣ЁЯжЛ",
          "ЁЯНФЁЯжкЁЯНЫЁЯН▓ЁЯеЧ",
          "ЁЯНОЁЯНУЁЯНТЁЯНСЁЯМ╢я╕П",
          "ЁЯзЛЁЯедЁЯзЛЁЯеЫЁЯН╖",
          "ЁЯНмЁЯНнЁЯзБЁЯОВЁЯНб",
          "ЁЯНиЁЯзЙЁЯН║тШХЁЯН╗",
          "ЁЯекЁЯезЁЯНжЁЯНеЁЯНЪ",
          "ЁЯлЦтШХЁЯН╣ЁЯН╖ЁЯеЫ",
          "тШХЁЯзГЁЯНйЁЯНжЁЯНЩ",
          "ЁЯНБЁЯМ╛ЁЯТоЁЯНВЁЯМ┐",
          "ЁЯМия╕ПЁЯМея╕ПтЫИя╕ПЁЯМйя╕ПЁЯМзя╕П",
          "ЁЯМ╖ЁЯП╡я╕ПЁЯМ╕ЁЯМ║ЁЯТР",
          "ЁЯТоЁЯМ╝ЁЯМ╗ЁЯНАЁЯНБ",
          "ЁЯзЯЁЯж╕ЁЯж╣ЁЯзЩЁЯС╕",
          "ЁЯзЕЁЯНаЁЯеХЁЯМ╜ЁЯеж",
          "ЁЯР╖ЁЯР╣ЁЯРнЁЯРиЁЯР╗тАНтЭДя╕П",
          "ЁЯжЛЁЯРЗЁЯРАЁЯРИЁЯРИтАНтмЫ",
          "ЁЯМ╝ЁЯМ│ЁЯМ▓ЁЯМ┤ЁЯМ╡",
          "ЁЯейЁЯНЛЁЯНРЁЯНИЁЯНЗ",
          "ЁЯН┤ЁЯН╜я╕ПЁЯФкЁЯН╢ЁЯеГ",
          "ЁЯХМЁЯП░ЁЯПйтЫйя╕ПЁЯПй",
          "ЁЯОЙЁЯОКЁЯОИЁЯОВЁЯОА",
          "ЁЯк┤ЁЯМ╡ЁЯМ┤ЁЯМ│ЁЯМ▓",
          "ЁЯОДЁЯОЛЁЯОНЁЯОСЁЯОО",
          "ЁЯжЕЁЯжЬЁЯХКя╕ПЁЯждЁЯжв",
          "ЁЯждЁЯжйЁЯжЪЁЯжГЁЯжЖ",
          "ЁЯРмЁЯжнЁЯжИЁЯРЛЁЯР│",
          "ЁЯРФЁЯРЯЁЯРаЁЯРбЁЯжР",
          "ЁЯжйЁЯжАЁЯжСЁЯРЩЁЯжк",
          "ЁЯРжЁЯжВЁЯХ╖я╕ПЁЯХ╕я╕ПЁЯРЪ",
          "ЁЯекЁЯН░ЁЯезЁЯНиЁЯНи",
          " ЁЯемЁЯНЙЁЯзБЁЯзЗ",
        ]

TAGMES = [ " **Hey inga va veh nee** ",
           " **VE-NN-A thalaiya yena da pandra** ",
           " **Nalavaneee saptiya yenna pandra** ",
           " **deiii nee lam yen irruka poidu appdey hehЁЯШЛ** ",
           " **Nanae kolanthai da nambumga da** ",
           " **moodhugula knife yedhutu yara kuthulam nu partha yenna da nee vanthu nikuraaЁЯЩГ** ",
           " **Ana solliten ithulam nalathuku illa parthukaa ! avalothan hanЁЯди** ",
           " **Oru flow la poiturukum bothu yevan da athu nadula comedy pannikituu __ odddu** ",
           " **Ama onu vanganum heh yenna vangalam solluuЁЯе▓** ",
           " **dei murugesha antha AK47 gun ha konjam kooda bore adikuthuЁЯШЛ** ",
           " **yenna da suda matikuthi ! manichidu talaivarey bullet podala** ",
           " **athu yeppadey da yunna sudanum nu kekum bothu mattum bullet kanumЁЯЩДЁЯдФ** ",
           " **yunnaku yenna mooku neelama irrukam ЁЯдФ! pakathu theru la poster la irrunthuchhiiiЁЯПГЁЯПГ** ",
           " **Ana yunnaku vai irruke yennaku mela irruku ЁЯЩДЁЯЩД** ",
           " **sari yedhachum nalla song sollu kepomЁЯл╢** ",
           " **paatu poda sonna yena yen da podura ! venna thalaiya** ",
           " **yenna game thala aduva neeЁЯШЫ! oru match polama** ",
           " **Ama yunna pathi onu sonnangley ath uumnai haЁЯдФ** ",
           " **sari yellame vithudu, nan oru 3 kelvi kekuren soluriya nu pakalam** ",
           " **yara nee neelam oru aley illaa venna thalaiyaЁЯдЧ** ",
           " **konjam kooda navura vidamatikuran heh yenna da venum yunnaku** ",
           " **Yevalo vati da sollurathu yunnaku mandai la brain heh illa da yunnaku venna thalaiya** ",
           " **Ana sathiyama sollala nee lam thiruntha mataЁЯе║ЁЯе║** ",
           " **ama nan paitiyakaran na nee yaruuЁЯШ╢** ",
           " **yunnaku vekam lam vratha da sena panni marri nikuraaЁЯдФ** ",
           " **appadey ha ithu vera theriyaama pochaЁЯШЬ** ",
           " **amaa yenna alaiyee kanum sethutiya** ",
           " **nalla thingura yenna vitutu nalla irrpa** ",
           " **sari satu butu nu sollu yenna venum sapuda apram kasu illanu nu soliduven** ",
           " **Nee nalavana illna ketavanuku mela nalavn haЁЯЩК** ",
           " **ama nee ipo yenna pandra yenna marri vetiya thane irrukaa apram yenga poreЁЯШ║** ",
           " **sari sari pesunathu pothum poi toonguЁЯе▓** ",
           " **yepayum happy ha samthosama irru apo than yunna pakuravanga irruntha ivana marri irrukanum nu ninachi santhosama irrupangaЁЯШЕ** ",
           " **illana irrukura vanagalaiyum auchi irruka vidu da venna ythalaiyaЁЯЩКЁЯЩК** ",
           " **Sooruu inga illaiyam pakathu veedu layum illaiyam agamothathuku sorru ilaiyamЁЯЩИЁЯЩИ** ",
           " **porathum pore irru kuli kulla thali vidurenЁЯХ│** ",
           " **sari apo nan kilamburen neeyum pesitu nalla urutitu poi toongu, thaniya daЁЯЩК** ",
           " **Nan nee avan avar ival iva yellarum ... onum illa..?ЁЯСА** ",
           " **yelai anga yenna da pandra inga va game adalam** ",
           " **sari bore adicha sollu game adalam** ",
           " **inga oruthan irrupan nalla parru yunnakula irrukpan ana irrukamatan avan yar??ЁЯШ╗** ",
           " **ama nee yaru sollu ?ЁЯЩГ** ",
           " **Ice Mittai Vangitariya ?ЁЯЩК** ",
           " **oru game adalam who is up ?ЁЯЩГ** ",
           ]

VC_TAG = [" **тЪШ ржЖржорж╛ржХрзЗ ржнрзБрж▓рзЗ ржпрж╛ржУ...ЁЯТе**",
         " **тЪШ ржЖржорж┐ рждрзЛржорж╛ржХрзЗ ржнрж╛рж▓рзЛржмрж╛рж╕рж┐ ржирж╛...ЁЯТе**",
         " **тЪШ ржПржЯрж╛ржХрзЗ рждрзЛржорж╛рж░ ржХрж░рзЛ ржкрж┐ржпрж╝рж╛, рждрзЛржорж╛рж░ ржХрж░рзЛ...ЁЯТе**",
         " **тЪШ ржЖржорж╛рж░ ржЧрзНрж░рзБржкрзЗржУ ржпрзЛржЧ ржжрж┐ржи...ЁЯТе**",
         " **тЪШ ржЖржорж┐ рж╣рзГржжржпрж╝рзЗ рждрзЛржорж╛рж░ ржирж╛ржо рж░рзЗржЦрзЗржЫрж┐...ЁЯТе**",
         " **тЪШ рждрзЛржорж╛рж░ рж╕ржм ржмржирзНржзрзБ ржХрзЛржерж╛ржпрж╝...ЁЯТе**",
         " **тЪШ ржХрж╛рж░ рж╕рзНржорзГрждрж┐рждрзЗ рждрзБржорж┐ рж╣рж╛рж░рж┐ржпрж╝рзЗ ржЧрзЗржЫрзЛ ржЖржорж╛рж░ ржнрж╛рж▓рзЛржмрж╛рж╕рж╛...ЁЯТе**",
         " **тЪШ рждрзЛржорж╛рж░ ржкрзЗрж╢рж╛ ржХрж┐...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрзЛржерж╛ржпрж╝ ржерж╛ржХрзЛ...ЁЯТе**",
         " **тЪШ рж╢рзБржн рж╕ржХрж╛рж▓, ржмрж╛ржмрзБ...ЁЯТе**",
         " **тЪШ рж╢рзБржн рж░рж╛рждрзНрж░рж┐, ржЕржирзЗржХ ржжрзЗрж░рж┐ рж╣ржпрж╝рзЗ ржЧрзЗржЫрзЗ...ЁЯТе**",
         " **тЪШ ржЖржорж╛рж░ ржЖржЬ ржЦрзБржм ржЦрж╛рж░рж╛ржк рж▓рж╛ржЧржЫрзЗ...ЁЯТе**",
         " **тЪШ ржЖржорж╛рж░ рж╕рж╛ржерзЗржУ ржХржерж╛ ржмрж▓...ЁЯТе**",
         " **тЪШ ржЖржЬ рж░рж╛рждрзЗрж░ ржЦрж╛ржмрж╛рж░рзЗрж░ ржЬржирзНржп ржХрж┐...ЁЯТе**",
         " **тЪШ ржХрж┐ рж╣ржЪрзНржЫрзЗ...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржорзЗрж╕рзЗржЬ ржжрж╛ржУ ржирж╛ ржХрзЗржи...ЁЯТе**",
         " **тЪШ ржЖржорж┐ ржирж┐рж░рзНржжрзЛрж╖...ЁЯТе**",
         " **тЪШ ржПржЯрж╛ ржЧрждржХрж╛рж▓ ржоржЬрж╛ ржЫрж┐рж▓, рждрж╛ржЗ ржирж╛...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржЧрждржХрж╛рж▓ ржХрзЛржерж╛ржпрж╝ ржмрзНржпрж╕рзНржд ржЫрж┐рж▓рзЗ...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ рж╕ржорзНржкрж░рзНржХрзЗ ржЖржЫрзЛ...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржЦрзБржм рж╢рж╛ржирзНржд ржерж╛ржХрзЛ ржмржирзНржзрзБ...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ ржЧрж╛ржЗрждрзЗ ржЬрж╛ржирзЛ, ржЧрж╛ржЗрждрзЗ...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ ржЖржорж╛рж░ рж╕рж╛ржерзЗ ржмрзЗржбрж╝рж╛рждрзЗ ржЖрж╕ржмрзЗ...ЁЯТе**",
         " **тЪШ рж╕ржмрж╕ржоржпрж╝ рж╣рж╛рж╕рж┐ржЦрзБрж╢рж┐ ржерзЗржХрзЛ ржмржирзНржзрзБ...ЁЯТе**",
         " **тЪШ ржЖржорж░рж╛ ржХрж┐ ржмржирзНржзрзБ рж╣рждрзЗ ржкрж╛рж░рж┐...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ ржмрж┐ржмрж╛рж╣рж┐ржд...ЁЯТе**",
         " **тЪШ ржПржд ржжрж┐ржи ржХрзЛржерж╛ржпрж╝ ржмрзНржпрж╕рзНржд ржЫрж┐рж▓рзЗ...ЁЯТе**",
         " **тЪШ рж▓рж┐ржЩрзНржХ ржмрж╛ржпрж╝рзЛрждрзЗ ржЖржЫрзЗ, ржПржЦржи ржпрзЛржЧ ржжрж┐рждрзЗ...ЁЯТе**",
         " **тЪШ ржоржЬрж╛ ржХрж░рж▓рж╛ржо...ЁЯТе**",
         " **тЪШ ржЖржкржирж┐ ржХрж┐ ржПржЗ ржЧрзНрж░рзБржкрзЗрж░ ржорж╛рж▓рж┐ржХржХрзЗ ржЪрзЗржирзЗржи...ЁЯТе**",
         " **тЪШ рждрзЛржорж╛рж░ ржХрж┐ ржХржЦржирзЛ ржоржирзЗ ржкржбрж╝рзЗ ржЖржорж╛ржпрж╝...ЁЯТе**",
         " **тЪШ ржЪрж▓рзЛ ржкрж╛рж░рзНржЯрж┐ ржХрж░рж┐...ЁЯТе**",
         " **тЪШ ржЖржЬ ржХрзЗржоржи ржПрж▓рзЛ...ЁЯТе**",
         " **тЪШ ржХрзЗржоржи ржХрж╛ржЯрж▓рзЛ рждрзЛржорж╛рж░ ржжрж┐ржи...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ ржжрзЗржЦрзЗржЫрзЛ...ЁЯТе**",
         " **тЪШ ржЖржкржирж┐ ржХрж┐ ржПржЦрж╛ржиржХрж╛рж░ ржкрзНрж░рж╢рж╛рж╕ржХ...ЁЯТе**",
         " **тЪШ ржЖржорж░рж╛ ржмржирзНржзрзБ рж╣рждрзЗ ржкрж╛рж░рж┐...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ рж╕ржорзНржкрж░рзНржХрзЗ ржЖржЫрзЛ...ЁЯТе**",
         " **тЪШ ржЖрж░ ржмржирзНржжрзА ржХрзЗржоржи ржЖржЫрзЗ...ЁЯТе**",
         " **тЪШ рждрзЛржорж╛ржХрзЗ ржЧрждржХрж╛рж▓ ржжрзЗржЦрзЗржЫрж┐...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрзЛржерж╛ ржерзЗржХрзЗ...ЁЯТе**",
         " **тЪШ ржЖржкржирж┐ ржХрж┐ ржЕржирж▓рж╛ржЗржирзЗ ржЖржЫрзЗржи...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ ржЖржорж╛рж░ ржмржирзНржзрзБ....ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ ржЦрзЗрждрзЗ ржкржЫржирзНржж ржХрж░...ЁЯТе**",
         " **тЪШ ржЖржорж╛ржХрзЗ ржЖржкржирж╛рж░ ржЧрзНрж░рзБржкрзЗ ржЕрзНржпрж╛ржб ржХрж░рзБржи, ржЖржорж┐ ржЧрж╛ржи ржмрж╛ржЬрж┐ржпрж╝рзЗ рж╕ржмрж╛ржЗржХрзЗ ржЯрзНржпрж╛ржЧ ржХрж░ржм....ЁЯТе**",
         " **тЪШ ржЖржЬ ржЖржорж┐ ржжрзБржГржЦрж┐ржд...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ рж╕рждрзНржп ржЦрзЗрж▓ржмрзЗ ржПржмржВ рж╕рж╛рж╣рж╕ ржХрж░ржмрзЗ...ЁЯТе**",
         " **тЪШ рждрзЛржорж╛рж░ ржоржд ржмржирзНржзрзБ ржерж╛ржХрж▓рзЗ ржЪрж┐ржирзНрждрж╛рж░ ржХрж┐ ржЖржЫрзЗ...ЁЯТе**",
         " **тЪШ ржХрж┐ рж╣ржпрж╝рзЗржЫрзЗ рждрзЛржорж╛рж░...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ ржЪржХрж▓рзЗржЯ ржЦрзЗрждрзЗ ржЪрж╛ржУ....ЁЯТе**",
         " **тЪШ рж╣рзНржпрж╛рж▓рзЛ ржмрж╛ржмрзБ...ЁЯТе**",
         " **тЪШ ржЖржорж╛рж░ рж╕рж╛ржерзЗ ржЪрзНржпрж╛ржЯ ржХрж░рзЛ...ЁЯТе**",
         " **тЪШ рждрзБржорж┐ ржХрж┐ ржмрж▓рзЛ...ЁЯТе**"
        ]


@app.on_message(filters.command(["entag", "englishtag" ], prefixes=["/", "@", "#"]))
async def mentionall(client, message):
    chat_id = message.chat.id
    if message.chat.type == ChatType.PRIVATE:
        return await message.reply("р╣П с┤Ы╩Ь╔кs с┤Дс┤Пс┤Нс┤Нс┤А╔┤с┤Е с┤П╔┤╩Я╩П ╥Ус┤П╩А ╔в╩Ас┤Пс┤Ьс┤Шs.")

    is_admin = False
    try:
        participant = await client.get_chat_member(chat_id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER
        ):
            is_admin = True
    if not is_admin:
        return await message.reply("р╣Пithu thaan thavarana seyal, Niruvagi kitta kelunga (admins).... ")

    if message.reply_to_message and message.text:
        return await message.reply("Msg ah tag pannaatha. ,/entag  nu thaniya podu ve-nn-a...")
    elif message.text:
        mode = "text_on_cmd"
        msg = message.text
    elif message.reply_to_message:
        mode = "text_on_reply"
        msg = message.reply_to_message
        if not msg:
            return await message.reply("Msg ah tag pannaatha. ,//entag  nu thaniya podu ve-nn-a...")
    else:
        return await message.reply("Msg ah tag pannaatha. ,//entag  nu thaniya podu ve-nn-a...")
    if chat_id in spam_chats:
        return await message.reply("р╣П с┤Ш╩Яс┤Зс┤Аsс┤З с┤Ас┤Ы ╥У╔к╩Аsс┤Ы sс┤Ыс┤Пс┤Ш ╩Ас┤Ь╔┤╔┤╔к╔┤╔в с┤Нс┤З╔┤с┤Ы╔кс┤П╔┤ с┤Ш╩Ас┤Пс┤Дс┤Зss...")
    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    async for usr in client.get_chat_members(chat_id):
        if not chat_id in spam_chats:
            break
        if usr.user.is_bot:
            continue
        usrnum += 1
        usrtxt += f"[{usr.user.first_name}](tg://user?id={usr.user.id}) "

        if usrnum == 1:
            if mode == "text_on_cmd":
                txt = f"{usrtxt} {random.choice(TAGMES)}"
                await client.send_message(chat_id, txt)
            elif mode == "text_on_reply":
                await msg.reply(f"[{random.choice(EMOJI)}](tg://user?id={usr.user.id})")
            await asyncio.sleep(4)
            usrnum = 0
            usrtxt = ""
    try:
        spam_chats.remove(chat_id)
    except:
        pass


@app.on_message(filters.command(["bntag"], prefixes=["/", "@", "#"]))
async def mention_allvc(client, message):
    chat_id = message.chat.id
    if message.chat.type == ChatType.PRIVATE:
        return await message.reply("р╣П с┤Ы╩Ь╔кs с┤Дс┤Пс┤Нс┤Нс┤А╔┤с┤Е с┤П╔┤╩Я╩П ╥Ус┤П╩А ╔в╩Ас┤Пс┤Ьс┤Шs.")

    is_admin = False
    try:
        participant = await client.get_chat_member(chat_id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER
        ):
            is_admin = True
    if not is_admin:
        return await message.reply("р╣П ithu thaan thavarana seyal, Niruvagi kitta kelunga (admins)... ")
    if chat_id in spam_chats:
        return await message.reply("р╣П с┤Ш╩Яс┤Зс┤Аsс┤З с┤Ас┤Ы ╥У╔к╩Аsс┤Ы sс┤Ыс┤Пс┤Ш ╩Ас┤Ь╔┤╔┤╔к╔┤╔в с┤Нс┤З╔┤с┤Ы╔кс┤П╔┤ с┤Ш╩Ас┤Пс┤Дс┤Зss...")
    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    async for usr in client.get_chat_members(chat_id):
        if not chat_id in spam_chats:
            break
        if usr.user.is_bot:
            continue
        usrnum += 1
        usrtxt += f"[{usr.user.first_name}](tg://user?id={usr.user.id}) "

        if usrnum == 1:
            txt = f"{usrtxt} {random.choice(VC_TAG)}"
            await client.send_message(chat_id, txt)
            await asyncio.sleep(4)
            usrnum = 0
            usrtxt = ""
    try:
        spam_chats.remove(chat_id)
    except:
        pass



@app.on_message(filters.command(["cancel", "enstop", "bnstop"]))
async def cancel_spam(client, message):
    if not message.chat.id in spam_chats:
        return await message.reply("р╣П innum arambikave illa pangu.")
    is_admin = False
    try:
        participant = await client.get_chat_member(message.chat.id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER
        ):
            is_admin = True
    if not is_admin:
        return await message.reply("р╣Пithu thaan thavarana seyal, Niruvagi kitta kelunga (admins).")
    else:
        try:
            spam_chats.remove(message.chat.id)
        except:
            pass
        return await message.reply(f"**Nee than niruthunatha**\n{message.from_user.mention}\n**Irrunga varen .. ЁЯЫ╡**")
          
